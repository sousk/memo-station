<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title><%= application_title %></title>
<%= tag "link", :rel => "shortcut icon", :href => "/favicon.ico" %>
<%= auto_discovery_link_tag :rss, :controller => "articles", :action => "rss" %>
<%= javascript_include_tag :defaults %>
<%= javascript_include_tag "nifty" %>
<%= stylesheet_link_tag "base", "niftyCorners" %>
<%= stylesheet_link_tag "niftyPrint", :media => "print" %>
<%= stylesheet_link_tag(css_url(:action => "base")).gsub(/\.css/, "")  %>
<%= stylesheet_link_tag(css_url(:action => "style")).gsub(/\.css/, "")  %>
<%= javascript_tag "
  Event.observe(window, 'load', function() {
    if (!NiftyCheck()) {
        return;
    }
    RoundedTop('div.roundedTitle','#{Palette[9]}','#{Palette[1]}');
  }, false);
" %>
</head>
<body>
<div id="container">
<div id="headerTop">
  <h1><%= link_to APPLICATION_TITLE, :controller => "" -%></h1>
  <div id="headerTopLink">
    <%= link_to icon_tag("user") + "マイページ", :controller => "mypage" %>
    &nbsp;&nbsp;
    <%= link_to icon_tag("folder_explore") + "最近見たメモ", :controller => "articles", :action => "recent_viewed" %>
    &nbsp;&nbsp;
    <% if @session[:user] -%>
    <%= link_to icon_tag("door_out") + "ログアウト", {:controller => "account", :action => "logout"}, :confirm => "本当にログアウトしてもよろしいですか？" %>
    <% else -%>
    <%= link_to icon_tag("door_in") + "ログイン", :controller => "account", :action => "login" %>
    <% end -%>
  </div>
  <div id="description">〜環境設定やプログラミングなどの雑多な情報をデータベースで集中管理する実験〜</div>
</div>
<div id="globalNaviArea" class="clearfix">
  <%= content_for_global_navi %>
  <div id="topic_path_list">
  <% if topic_path_list -%>
  <%= topic_path_list %>
  <% else -%>
  &nbsp;
  <% end -%>
  </div>
</div>
<div id="contentMainWithSidebar" class="clearfix">
  <div id="sidebar" class="sidebar">
    <div id="search-indicator" style="display: none">
    検索中...<%= icon_tag("database_gear") %>
    </div>
    <div id="search_results"></div>
    <%= render :partial => "users/sidebar" %>
    <%= render_component(:controller => "articles", :action => "sidebar_tag_cloud") %>
    <%= render_component(:controller => "articles", :action => "sidebar_most_viewed_articles") %>
    <%= render_component(:controller => "articles", :action => "sidebar_latest_articles") %>
    <%= render :partial => "layouts/search" %>
    <%= render :partial => "layouts/syndicate" %>
  </div>
<div id="contentMain">
  <%- if flash[:notice] -%>
    <div class="flashNotice" id="notice">
      <%= flash[:notice] %>
    </div>
    <%- if flash[:notice_duration] -%>
      <%= javascript_tag "
         Event.observe(window, 'load', function() {
           setTimeout(function() {
             $('notice').visualEffect('fade', {duration: 0.5});
           }, #{flash[:notice_duration]} * 1000.0);
         }, false);
      " -%>
    <%- end -%>
  <%- end -%>
  <%= @content_for_layout %>
</div>
</div>
<%= render :partial => "layouts/footer" %>
</div>
</body>
</html>
